# Disk App

RESTful API для Xsolla

Реализован RESTful API сервис для работы внешних пользователей с файловой системой на сервере. Сервис позволяет пользователям регистрироваться в системе, использовать CRUD-команды для манипуляции со своими файлами на сервере, запрашивать метаданные указанного файла, а также получать список всех доступных файлов в хранилище. Хранилище реализовано в виде разделяемого ресурса, то есть все пользователи имеют возможность получать любую информацию обо всех файлах (в том числе и сам файл). Однако, операции обновления и удаления доступны только для создателя файла.


Примеры подобных сервисов:
* AWS S3 API http://docs.aws.amazon.com/AmazonS3/latest/API/APIR
* Dropbox Core API https://www.dropbox.com/developers/core/docs


Для регистрации пользователя используйте следующую команду:
1. POST /register - для регистрации аутентификация не требуется. Пример тела запроса: {"username":"vasya", "password":"vasya"}

Пользователь имеет возможность использовать в системе следующие команды API (для выполнения каждой команды требуется Basic Auth аутентификация):
1. **Создать файл из данных в запросе.** 
POST /files/put - тФайл передаётся в теле запроса form-data, где key = 'file', value - непосредственно файл.

2. **Обновить содержимое файла из данных в запросе.** 
POST /files/update - Файл передаётся в теле запроса form-data, где key = 'file', value - непосредственно файл.

3. **Получить содержимое файла.** 
GET /files/{filename} - Возвращает указанный в {filename} файл в бинарном виде, если этот файл существует.

4. **Получить метаданные файла.** 
GET /metadata/{filename} - Возвращает метаданные указанного в {filename} файла.

5. **Получить список файлов.** 
GET /files - Возвращает список файлов, доступных в хранилище.

6. **Удалить указанный файл (бонусная фича).** 
POST /files/delete/{filename} - Удаляет указанный в {filename} файл, если он принадлежит аутентифицированному пользователю.


Также в проекте реализованы модульные тесты. Для того, чтобы выполнить все тесты, перейдите в папку проекта и используйте следующую команду:
* vendor\bin\phpunit tests


Список дополнительных фич, указанных в задании, которые были реализованы:
1. Работа с PHP экосистемой
* Использование composer
* Использование сторонних библиотек и фреймворков (Silex, PHPUnit)
2. Оформление
* README.md
* Оформленный проект на Github
3. Оптимизация
* Разруливание конкурентного доступа к файлу (за счет реализации в системе пользователей)
4. Безопасность
* Ограничение директории, доступной для записи
* Механизм авторизации в апи (реализовано через Basic Auth)
* Привязка файла к клиенту-создателю и запрет на изменение для других клиентов.
5. Окружение
* Нет
6. Остальное
* Правильный Content-Type в ответах


Предложения по улучшению функционала:
1. Реорганизовать тесты:
* организовать порядок запускаемых тестов
* вынести функционал, используемый в каждом тесте, в отдельный класс и сделать его родительским
* использовать DataProvider для уменьшения количества тестовых функций (в идеале на одну тестируемую функцию должна быть одна тестирующая с определенным набором входных значений и ожидаемых результатов)
* использовать Mock-объекты и Fixtures для повышения изолированности тестируемого кода и независимости его от внешних условий
2. Организовать более разветвлённое дерево ошибок для лучшей локализации потенциальных ошибок.
3. Использовать Doctrine ORM и Query Builder для повышения уровня удобочитаемости запросов и безопасности доступа к БД.
4. Реализация оставшихся фич, указанных в задании (в первую очередь по оптимизации и безопасности).